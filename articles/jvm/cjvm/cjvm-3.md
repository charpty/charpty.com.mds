> 笔者博客地址：https://charpty.com       
> 本文代码委托在：https://github.com/charpty/cjvm



在说JVM的指令集前，先总结下近几篇文章以及后续的编码思路。在Java虚拟机规范中，按照

```java
整体架构 -> 编译器 -> class文件定义 -> 启动与类加载 -> 指令集
```

的方式讲述了虚拟机的设计，在张秀宏老师的动手用go写Java虚拟机书中，则是避开了很多复杂的模式，实现了一个实验性质的Java虚拟机，同时笔者也受封亚飞的揭秘Java虚拟机文章的影响，希望实现一个带动态编译和解释执行的虚拟机。

如此多的方式，笔者最终选择了一种“渐进式”的形式实现，一方面是考虑先易后难便于写代码，二来便于写文章，最终形式如下

```java
class文件解析 -> 运行时数据区 -> 指令集 -> JNI -> 内存管理与GC -> 启动与JDK加载 -> 实战运行网站 -> JIT
```

其中`class文件解析`和`运行时数据区`和在之前已经写过，但是笔者在写后面文章时也发现了之前思路的一些问题，为了保留思路样本，就不直接修改原来的文章了，而是出“修订版”，比如对于文章`cjvm-1.md`，则其修订版本为`cjvm-1-m1.md`、`cjvm-1-m2.md`等，在修订版本前面说明修订的内容。



## 指令集概述

按虚拟机规范，将指令集划分为11中类型，分别是

- 常量：将一个字面常量推入栈顶，或从常量池获取常量并推入栈顶，最出名的是ldc指令

- 加载：将本地变量表中的某个变量推入栈顶

- 存储：和加载指令对应，这是将栈顶变量写回到本地变量表中

- 栈：对栈的各种操作

- 数学：在栈上进行加减乘除、位移、异或等数学操作

- 转换：long、int、char、byte、short等类型的各种转换操作

- 比较：比较两个变量并压入比较结果，同时也是条件语句实现的关键，通过比较进行跳转

- 控制：强制跳转和结果返回

- 引用：属性赋值、方法调用、并发同步、对象创建、抛出异常等操作

- 扩展：宽字扩展、多维数组相关指令

- 保留指令：仅关心调试指令即可



Java虚拟机规范一共规定了205条指令，其中3条是保留指令，在实际运行期间共有202条指令，通过仅仅200多条指令，就能模拟大多数汇编指令做的事情，简单又强大！



## 常量指令





## 加载指令

## 存储指令

## 栈指令

## 数学指令

## 转换指令

## 比较指令

## 控制指令

## 引用指令

## 扩展指令

## 执行引擎














